import{_ as R,m as v,a as f,r as _,o as i,c as n,d as u,b as t,n as g,F as p,i as y,j as F,v as D,e as r,t as c,f as m,w as k,k as d}from"./index-dea600ad.js";import{L as U}from"./index-54b2cda4.js";import{P as V}from"./PaginationComponent-6e528c57.js";import{c as w}from"./cart-94e17664.js";import{c as P}from"./collect-b1391dce.js";import{m as S}from"./thousands_separators-01acb187.js";import"./_commonjsHelpers-042e6b4d.js";import"./sweetalert2.all-6567ce3e.js";const{VITE_URL:x,VITE_PATH:T}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"youting",BASE_URL:"/cafe-ecommerce/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},B={data(){return{isLoading:!1,products:[],allProducts:[],pagination:{},categories:[],selectedCategory:"",searchContent:"",searchStatus:!1}},mixins:[S],watch:{$route(){this.selectedCategory=this.$route.query.query||"",this.getProducts()},searchContent(s){s||this.getProducts()}},components:{Pagination:V,Loading:U},methods:{...v(w,["addToCart","getCarts"]),...v(P,["addToCollect","getCollects","removeCollect"]),getProducts(s=1){this.searchStatus=!1,this.searchContent="",this.isLoading=!0,this.$http(`${x}/v2/api/${T}/products?page=${s}&category=${this.selectedCategory}`).then(o=>{this.products=o.data.products,this.pagination=o.data.pagination,this.isLoading=!1}).catch(o=>{alert(o.response.data.message),this.isLoading=!1})},getCategory(){this.$http(`${x}/v2/api/${T}/products/all`).then(s=>{const o=s.data.products;this.allProducts=o;const b=[];o.forEach(h=>{b.push(h.category)}),this.categories=b.filter((h,a,l)=>l.indexOf(h)===a)}).catch(s=>{alert(s.response.data.message)})}},computed:{isFav(){return s=>this.collects.filter(o=>o.id===s).length},searchResult(){return this.allProducts.filter(s=>{const o=new RegExp(this.searchContent.split("").join(".*"),"i");return o.test(s.description)||o.test(s.title)})},...f(w,["state"]),...f(P,["collects"])},mounted(){this.getCollects(),this.getCategory(),this.selectedCategory=this.$route.query.query||"",this.getProducts()}},N=t("div",{class:"position-relative"},[t("img",{class:"top-50 imgset",src:"https://storage.googleapis.com/vue-course-api.appspot.com/youting/1679368088772.png?GoogleAccessId=firebase-adminsdk-zzty7%40vue-course-api.iam.gserviceaccount.com&Expires=1742169600&Signature=gkPGxdJV09tlG7eTyLkc3UlmhEM8fwVRUM%2BGt885Sz2ZHBfJU132NUGaF0phyjiGlaFHaCl1Hi4btvrI5848F5v5eRFi5LjyN4wJbKpa9%2FzD8tMlwU13ZC4hN4EL5XpFGwLHSa9sDfPWh9UySEWyZvoXbM98yXi6RgGKGbPMTYr%2FWOJbm46bzCkgwyU3xCMmWkrhqzmaxeA1l900dRYxpeaHvcANukTdsBdyC0d4QBIDJusZohHbJE0E8tjAInbDsYx466vGO4Buyg4qD8irn78jjYeOaTzQiCOBgWOL0GZPjiUI6I1fO3cvObMiloDB1QhWYwViuR652egoDOuR6g%3D%3D"}),t("p",{class:"position-absolute top-50 start-50 p-2 bg-dark bg-opacity-50 translate-middle fs-1 text-white border-bottom border-4 border-light"},[t("i",{class:"bi bi-cup-hot"}),r(" 產品 ")])],-1),j={class:"container mt-3"},G={class:"row"},O={class:"col-md-6 col-lg-5 mb-3"},I={class:"btn-group",role:"group","aria-label":"Basic example"},M=["onClick"],z={class:"col-md-6 col-lg-4 ms-auto"},A={class:"input-group mb-3"},H={class:"row"},q={class:"mb-3"},$=t("i",{class:"bi bi-x-circle"},null,-1),J={class:"card product-card"},W={class:"card-head"},Y=["src","title"],Z={class:"card-body"},Q={class:"card-title"},X={class:"card-text"},K={class:"text-muted text-decoration-line-through"},tt={class:"d-flex justify-content-between"},et=["disabled","onClick"],st={key:0,class:"spinner-grow text-secondary spinner-grow-sm"},ot=["onClick"],it=t("i",{class:"bi bi-heart"},null,-1),nt=["onClick"],at=t("i",{class:"bi bi-heart-fill text-danger"},null,-1),rt=[at],lt={key:0,class:"col text-center min-body-heigh"},ct=t("h2",null,"查無商品",-1),dt=t("i",{class:"bi bi-bag-x",style:{"font-size":"5rem"}},null,-1),ht=[ct,dt],ut={class:"card product-card"},gt={class:"card-head"},pt=["src","title"],mt={class:"card-body"},bt={class:"card-title"},_t={class:"card-text"},yt={class:"text-muted text-decoration-line-through"},Ct={class:"d-flex justify-content-between"},vt=["onClick"],ft={key:0,class:"spinner-grow text-secondary spinner-grow-sm"},kt=["onClick"],wt=t("i",{class:"bi bi-heart"},null,-1),Pt=["onClick"],xt=t("i",{class:"bi bi-heart-fill text-danger"},null,-1),Tt=[xt],Et={key:0,class:"d-flex justify-content-center"};function Lt(s,o,b,h,a,l){const E=_("loading"),C=_("RouterLink"),L=_("Pagination");return i(),n("div",null,[u(E,{active:a.isLoading,loader:"dots",color:"#FCF8F3","background-color":"#676767"},null,8,["active"]),N,t("div",j,[t("div",G,[t("div",O,[t("div",I,[t("button",{type:"button",class:g(["btn btn-outline-primary",{"btn-primary text-white":a.selectedCategory===""}]),onClick:o[0]||(o[0]=()=>s.$router.push("/products"))}," 全部產品 ",2),(i(!0),n(p,null,y(a.categories,e=>(i(),n("button",{type:"button",class:g(["btn btn-outline-primary",{"btn-primary text-white":a.selectedCategory===e}]),key:e,onClick:()=>s.$router.push(`/products?query=${e}`)},c(e),11,M))),128))])]),t("div",z,[t("div",A,[F(t("input",{type:"text",class:"form-control border-bottom border-0 rounded-0",placeholder:"搜尋產品","onUpdate:modelValue":o[1]||(o[1]=e=>a.searchContent=e)},null,512),[[D,a.searchContent]])])])]),t("div",H,[a.searchContent?(i(),n(p,{key:0},[t("h3",q,[r(" 以下為您顯示 "+c(a.searchContent)+" 的結果 ",1),t("button",{class:"btn btn-outline-primary btn-sm mt-2",onClick:o[2]||(o[2]=()=>l.getProducts())},[$,r(" 取消搜尋 ")])]),(i(!0),n(p,null,y(l.searchResult,e=>(i(),n("div",{key:e.id,class:"col-lg-4 col-md-6 mb-3"},[u(C,{class:g({"pe-none":s.state===e.id}),to:`products/${e.id}`},{default:k(()=>[t("div",J,[t("div",W,[t("img",{class:"card-img-top bg-cover",height:"300",src:e.imageUrl,title:e.title},null,8,Y)]),t("div",Z,[t("h5",Q,c(e.title),1),t("p",X,[r(" NT$ "+c(s.thousands(e.price))+" / ",1),t("small",K,"NT$ "+c(s.thousands(e.origin_price)),1)]),t("div",tt,[t("button",{type:"button",class:"btn btn-primary me-auto",disabled:s.state===e.id,onClick:d(()=>s.addToCart(e.id),["prevent"])},[s.state===e.id?(i(),n("span",st)):m("",!0),r(" 加入購物車 ")],8,et),l.isFav(e.id)?(i(),n("button",{key:1,type:"button",class:"btn btn-outline-primary",onClick:d(()=>s.removeCollect(e),["prevent"])},rt,8,nt)):(i(),n("button",{key:0,type:"button",class:"btn btn-sm rounded btn-outline-primary",onClick:d(()=>s.addToCollect(e),["prevent"])},[it,r(" 加入收藏 ")],8,ot))])])])]),_:2},1032,["class","to"])]))),128)),l.searchResult.length===0?(i(),n("div",lt,ht)):m("",!0)],64)):(i(!0),n(p,{key:1},y(a.products,e=>(i(),n("div",{key:e.id,class:"col-lg-4 col-md-6 mb-3"},[u(C,{class:g({"pe-none":s.state===e.id}),to:`products/${e.id}`},{default:k(()=>[t("div",ut,[t("div",gt,[t("img",{class:"card-img-top bg-cover",height:"300",src:e.imageUrl,title:e.title},null,8,pt)]),t("div",mt,[t("h5",bt,c(e.title),1),t("p",_t,[r(" NT$ "+c(s.thousands(e.price))+" / ",1),t("small",yt,"NT$ "+c(s.thousands(e.origin_price)),1)]),t("div",Ct,[t("button",{type:"button",class:"btn btn-primary me-auto",onClick:d(()=>s.addToCart(e.id),["prevent"])},[s.state===e.id?(i(),n("span",ft)):m("",!0),r(" 加入購物車 ")],8,vt),l.isFav(e.id)?(i(),n("button",{key:1,type:"button",class:"btn btn-outline-primary",onClick:d(()=>s.removeCollect(e),["prevent"])},Tt,8,Pt)):(i(),n("button",{key:0,type:"button",class:"btn btn-sm rounded btn-outline-primary",onClick:d(()=>s.addToCollect(e),["prevent"])},[wt,r(" 加入收藏 ")],8,kt))])])])]),_:2},1032,["class","to"])]))),128))]),a.searchContent?m("",!0):(i(),n("div",Et,[u(L,{pagination:a.pagination,onEmitPage:l.getProducts},null,8,["pagination","onEmitPage"])]))])])}const jt=R(B,[["render",Lt]]);export{jt as default};
